<script>
  // Force backend base at runtime
  window.__VITE_API_BASE__ = 'https://almosthuman-starter.onrender.com';

  // Hard redirect any relative /api/* request to the backend host
  (function () {
    const BACKEND = 'https://almosthuman-starter.onrender.com';
    const origFetch = window.fetch;

    window.fetch = function (input, init) {
      try {
        // Normalize to string URL
        const urlStr = typeof input === 'string' ? input : (input && input.url) || '';

        // If code calls '/api/...' or './api/...', rewrite to absolute backend URL
        if (urlStr.startsWith('/api/') || urlStr.startsWith('./api/')) {
          const newUrl = BACKEND + (urlStr.startsWith('./') ? urlStr.slice(1) : urlStr);
          console.log('[FETCH PATCH] â†’', newUrl);
          return origFetch(newUrl, init);
        }
      } catch (e) {
        console.warn('[FETCH PATCH] error inspecting request', e);
      }
      return origFetch(input, init);
    };
  })();
</script>
