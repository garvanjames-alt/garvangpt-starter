<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Admin: Search Expand</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:2rem}
    input,button{font-size:16px}
    #out{white-space:pre-wrap;background:#f6f8fa;border:1px solid #e5e7eb;border-radius:8px;padding:12px;margin-top:16px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .hint{margin:12px 0 16px;color:#444}
    .spacer{flex:1}
  </style>
</head>
<body>
  <h1>Admin: Search &rarr; Expand</h1>
  <p class="hint">Try: <code>panadol</code>, <code>acyclovir</code>, <code>amoxil</code>, <code>ibuprofen</code>, <code>omeprazole</code></p>

  <div class="row" style="margin-bottom:8px;">
    <form id="f" class="row" onsubmit="return false;">
      <input id="q" placeholder="enter term…" required />
      <button id="btnExpand" type="submit">Expand</button>
    </form>
    <span class="spacer"></span>
    <button id="btnSyns" title="Show all synonym groups">Show synonyms</button>
  </div>

  <div id="out">result will appear here…</div>

  <script>
    const f = document.getElementById('f');
    const q = document.getElementById('q');
    const out = document.getElementById('out');
    const btnSyns = document.getElementById('btnSyns');

    async function expandTerm() {
      out.textContent = 'Loading…';
      try {
        const url = `/api/admin/search/expand?q=${encodeURIComponent(q.value.trim())}`;
        const res = await fetch(url, { credentials: 'include' });
        const data = await res.json();
        out.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        out.textContent = 'Error: ' + (err && err.message || err);
      }
    }

    async function showSynonyms() {
      out.textContent = 'Loading synonyms…';
      try {
        const res = await fetch('/api/admin/search/synonyms', { credentials: 'include' });
        const data = await res.json();
        out.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        out.textContent = 'Error: ' + (err && err.message || err);
      }
    }

    f.addEventListener('submit', expandTerm);
    btnSyns.addEventListener('click', showSynonyms);

    // convenience: focus the box on load
    q.focus();
  </script>
</body>
</html>
